<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Freewar Chat Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { margin: 5px; padding: 10px 20px; }
        #logs { white-space: pre-wrap; background-color: #f5f5f5; padding: 10px; border: 1px solid #ccc; margin-top: 20px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Freewar Chat Tracker</h1>

    <div>
        <h2>Welt auswählen</h2>
        <div>
            <button onclick="loadLog('global')">Global</button>
            <script>
                for (let i = 1; i <= 14; i++) {
                    document.write(`<button onclick="loadLog('welt${i}')">Welt ${i}</button>`);
                }
            </script>
        </div>
    </div>

    <div style="margin-top: 20px;">
        <button style="background-color: red; color: white;" onclick="deleteCurrentLog()">Aktuellen Log löschen</button>
        <span id="status" style="margin-left: 15px; color: green;"></span>
    </div>

    <div id="logs">Wähle eine Welt, um den Log anzuzeigen.</div>

    <script>
        let currentFile = "";

        function loadLog(welt) {
            const filename = `${welt}_chatlog.txt`;
            currentFile = filename;

            fetch(`/${filename}`)
                .then(response => {
                    if (!response.ok) throw new Error("Datei nicht gefunden");
                    return response.text();
                })
                .then(data => {
                    document.getElementById("logs").innerText = data;
                    document.getElementById("status").innerText = `Log von ${filename} geladen.`;
                })
                .catch(error => {
                    document.getElementById("logs").innerText = "Kein Log gefunden.";
                    document.getElementById("status").innerText = `Fehler: ${error.message}`;
                });
        }

        function deleteCurrentLog() {
            if (!currentFile) {
                alert("Bitte zuerst eine Welt auswählen.");
                return;
            }

            fetch(`/delete/${currentFile}`, { method: "POST" })
                .then(response => response.text())
                .then(data => {
                    document.getElementById("status").innerText = data;
                    document.getElementById("logs").innerText = "";
                    currentFile = "";
                })
                .catch(error => {
                    document.getElementById("status").innerText = "Fehler beim Löschen.";
                });
        }
    </script>
</body>
</html>
